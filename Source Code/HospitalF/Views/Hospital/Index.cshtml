@model HospitalF.Models.HospitalModel
@using HospitalF.Constant
@using HospitalF.Entities;
@using HospitalF.Models
@{
    ViewBag.Title = "Thông tin bệnh viện";
}


<section id="widget-grid" class="">

    <!-- row -->
    <div class="row">

        <!-- NEW WIDGET START -->
        <article class="col-sm-12 col-md-12 col-lg-12">

            <!-- Widget ID (each widget will need unique ID)-->
            <div class="jarviswidget" id="wid-id-0" data-widget-colorbutton="false" data-widget-editbutton="false">
                <header style="border: none; height: 40px;">
                    <span class="widget-icon" style="font-size: 180%;"><i class="fa fa-eye"></i></span>
                    <h1 style="line-height: 40px; padding-left: 30px;">Thông tin bệnh viện</h1>
                </header>

                <!-- widget div-->
                <div style="border: none;">

                    <!-- widget edit box -->
                    <div class="jarviswidget-editbox">
                        <!-- This area used as dropdown edit box -->

                    </div>
                    <!-- end widget edit box -->

                    <!-- widget content -->
                    <div class="widget-body">

                        <form class="form-horizontal" action="#">
                            @Html.TextBoxFor(m => m.HospitalID, new { @type = "hidden" })
                            <fieldset id="BasicInfor">
                                <legend>
                                    <span>Thông tin căn bản</span>
                                    @Html.ActionLink("Chỉnh sửa", Constants.HospitalBasicInforUpdateAction, Constants.HospitalController, new
                               {
                                   hospitalId = Model.HospitalID
                               }, new { @style = "float:right;", @class = "btn btn-primary" })
                                </legend>
                                <div class="form-group">
                                    <label class="col-md-2 control-label">Tên bệnh viện</label>
                                    <div class="col-md-6">
                                        <label class="control-label" style="text-align: left;">@Model.HospitalName</label>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-md-2 control-label">Website</label>
                                    <div class="col-md-6">
                                        <label class="control-label" style="text-align: left;"><a href="@Model.Website">@Model.Website</a></label>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-md-2 control-label">Loại hình dịch vụ</label>
                                    <div class="col-md-6">
                                        <label class="control-label" style="text-align: left;">@Model.HospitalTypeName</label>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-md-2 control-label">Địa chỉ</label>
                                    <div class="col-md-6">
                                        <label class="control-label" style="text-align: left;">@Model.FullAddress</label>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-md-2 control-label">Số điện thoại chính</label>
                                    <div class="col-md-6">
                                        <label class="control-label" style="text-align: left;">@Model.PhoneNo</label>
                                    </div>
                                </div>
                                @if (Model.PhoneNo2 != null)
                                {
                                    <div class="form-group">
                                        <label class="col-md-2 control-label">Số điện thoại thay thế</label>
                                        <div class="col-md-6">
                                            <label class="control-label" style="text-align: left;">@Model.PhoneNo2</label>
                                        </div>
                                    </div>
                                }@if (Model.PhoneNo3 != null)
                                 {
                                    <div class="form-group">
                                        <label class="col-md-2 control-label">Số điện thoại</label>
                                        <div class="col-md-6">
                                            <label class="control-label" style="text-align: left;">@Model.PhoneNo3</label>
                                        </div>
                                    </div>
                                 }
                                <div class="form-group">
                                    <label class="col-md-2 control-label">Số Fax</label>
                                    <div class="col-md-6">
                                        <label class="control-label" style="text-align: left;">@Model.Fax</label>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label class="col-md-2 control-label">Lịch khám ngày thường</label>
                                    <div class="col-md-6">
                                        <label class="control-label" style="text-align: left;">@Model.OrdinaryStartTime</label>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-md-2 control-label">Lịch khám ngày lễ/Tết</label>
                                    <div class="col-md-6">
                                        <label class="control-label" style="text-align: left;">@Model.HolidayStartTime</label>
                                    </div>
                                </div>
                                @{string allow = "";
                                  string notAllow = "checked";
                                  if (Model.IsAllowAppointment == true)
                                  {
                                      allow = "checked";
                                      notAllow = "";
                                  }
                                }
                                <div class="form-group">
                                    <label class="col-md-2 control-label"></label>
                                    <div class="col-md-6">
                                        <div class="radio">
                                            <label>
                                                <input type="radio" class="radiobox style-0" @allow name="style-0" disabled>
                                                <span>Cho phép đăng ký khám trực tuyến</span>
                                            </label>
                                        </div>
                                        <div class="radio">
                                            <label>
                                                <input type="radio" class="radiobox style-0" @notAllow name="style-0" disabled>
                                                <span>Không có dịch vụ đăng ký khám trực tuyến</span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </fieldset>

                            <fieldset>
                                <legend>Các bác sĩ</legend>
                                <div class="well" style="width: 50%;">
                                    <div class="input-group">
                                        @*<input class="form-control" type="text" placeholder="Tên bác sĩ" style="width: 40%;">*@
                                        @Html.TextBoxFor(m => m.DoctorName, new
                                   {
                                       @type = "text",
                                       @class = "form-control",
                                       @placeholder = Constants.DoctorNameViet,
                                       @style = "width:40%;"
                                   })
                                        @*<select class="form-control" id="select-1" style="width: 60%;">
                                            <option>Chuyên khoa</option>
                                        </select>*@
                                        @Html.DropDownListFor(m => m.SpecialityID, (SelectList)ViewBag.SpecialityList,
                                                Constants.RequireSpeciality, new
                                                {
                                                    @class = "form-control",
                                                    @style = "width: 60%;"
                                                })
                                        <div class="input-group-btn">
                                            <button class="btn btn-default btn-primary" type="button" id="Search">
                                                <i class="fa fa-search"></i>Tìm kiếm
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <section class="col col-8">
                                    <img src="../Content/img/Status/Invalid.ico" class="resizeIcon"
                                        style="display: none;" id="invalidIconUser">
                                    <span id="search-doctor-message"></span>
                                </section>

                                <div id="SearchResult">
                                    <br />
                                    <!--Search result display here-->

                                </div>
                                <!-- end widget -->

                            </fieldset>

                            <fieldset class="demo-switcher-1">
                                <legend><span>Chuyên khoa - Dịch vụ - Cơ sở vật chất</span>
                                    @*<a id="modal_trigger" href="#modal" class="btn btn-primary" style="float: right;">Chỉnh sửa</a>*@

                                    @Html.ActionLink("Chỉnh sửa", Constants.SpecialityServiceFacilityUpdateAction, Constants.HospitalController, new
                               {
                                   hospitalId = Model.HospitalID
                               }, new { @style = "float:right;", @class = "btn btn-primary" })
                                </legend>
                                <section class="col col-6">
                                    <div class="service-facility">
                                        <label class="control-label"><strong>Chuyên khoa</strong></label>
                                        <div style="width: 100%; margin-left: 20px;">
                                            @{List<Speciality> SpecialityList = new List<Speciality>();
                                              Speciality sp = null;
                                              foreach (SelectListItem item in ViewBag.SpecialityList)
                                              {
                                                  sp = new Speciality();
                                                  sp.Speciality_ID = Int32.Parse(item.Value.Trim());
                                                  sp.Speciality_Name = item.Text;
                                                  SpecialityList.Add(sp);
                                              }
                                              for (int i = 0; i < SpecialityList.Count; i++)
                                              {
                                                  if (i == SpecialityList.Count - 1)
                                                  {
                                                      break;
                                                  }
                                                  int tempI = i;
                                                <div class="form-group">
                                                    @for (int j = tempI; j < tempI + 3 && j < SpecialityList.Count; j++)
                                                    {
                                                        <label class="col-md-2 control-label" style="text-align: left; margin-left: 2%;">@SpecialityList[j].Speciality_Name</label>
                                                        if ((j + 1) == (tempI + 3))
                                                        {
                                                            i = j;
                                                        }
                                                    }
                                                </div>
                                              }
                                            }
                                        </div>
                                    </div>
                                </section>

                                <section class="col col-6">
                                    <div class="service-facility">
                                        <label class="control-label"><strong>Dịch vụ</strong></label>
                                        <div style="width: 100%; margin-left: 20px;">

                                            @{List<ServiceEntity> ServiceList = (List<ServiceEntity>)ViewBag.ServiceList;
                                              if (ServiceList == null || ServiceList.Count() == 0)
                                              {
                                                <h5>Bệnh viện hiện chưa có dịch vụ nào</h5>
                                              }
                                              else
                                              {
                                                  for (int i = 0; i < ServiceList.Count; i++)
                                                  {
                                                      if (i == ServiceList.Count - 1)
                                                      {
                                                          break;
                                                      }
                                                      int tempI = i;
                                                     
                                                <div class="form-group">

                                                    @for (int j = tempI; j < tempI + 3 && j < ServiceList.Count; j++)
                                                    {
                                                        <label class="col-md-2 control-label" style="text-align: left; margin-left: 2%;">
                                                            @ServiceList[j].Service_Name
                                                        </label>
                                                        if ((j + 1) == (tempI + 3))
                                                        {
                                                            i = j;
                                                        }
                                                    }
                                                </div>
                                                  }
                                              }
                                            }
                                        </div>
                                    </div>
                                </section>
                                <section class="col col-6">
                                    <div class="service-facility">
                                        <label class="control-label"><strong>Cơ sở vật chất</strong></label>
                                        <div style="width: 100%; margin-left: 20px;">

                                            @{List<FacilityEntity> FacilityList = (List<FacilityEntity>)ViewBag.FacilityList;
                                              if (FacilityList == null || FacilityList.Count() == 0)
                                              {
                                                <h5>Bệnh viện hiện chưa có cơ sở vật chất nào</h5>
                                              }
                                              else
                                              {
                                                  for (int i = 0; i < FacilityList.Count; i++)
                                                  {
                                                      if (i == FacilityList.Count - 1)
                                                      {
                                                          break;
                                                      }
                                                      int tempI = i;
                                                <div class="form-group">
                                                    @for (int j = tempI; j < tempI + 3 && j < FacilityList.Count; j++)
                                                    {
                                                        <label class="col-md-2 control-label" style="text-align: left; margin-left: 2%;">@FacilityList[j].Facility_Name</label>
                                                        if ((j + 1) == (tempI + 3))
                                                        {
                                                            i = j;
                                                        }
                                                    }
                                                </div>
                                                  }
                                              }
                                            }
                                        </div>
                                    </div>

                                </section>
                            </fieldset>
                        </form>

                    </div>
                    <!-- end widget content -->

                </div>
                <!-- end widget div -->

            </div>
            <!-- end widget -->
        </article>
        <!-- WIDGET END -->

    </div>
</section>

@*popup dialog*@
<script type="text/javascript" src="~/Content/js/jquery-1.11.0.min.js"></script>
<script type="text/javascript" src="~/Content/js/jquery.leanModal.min.js"></script>
<link rel="stylesheet" href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css" />
<link type="text/css" rel="stylesheet" href="~/Content/css/leanModel.css" />


<style>
    .service-facility
    {
        width: 100%;
        margin-left: 10px;
    }

    .resizeIcon
    {
        width: 16px;
        height: auto;
    }

    h2
    {
        margin: 0px 0px;
    }

    h5
    {
        margin-left: 20px;
    }

    div.dt-bottom-row
    {
        background: #fafafa;
        font-size: 11px;
        overflow: hidden;
        padding: 5px 10px;
        border-top: 1px solid #ccc;
        -webkit-box-shadow: inset 0 1px #fff;
        -ms-box-shadow: inset 0 1px #fff;
        box-shadow: inset 0 1px #fff;
    }

    span.date
    {
        width: 26px;
        height: 26px;
        text-align: center;
        line-height: 26px;
        background: #ECE9E9;
        font-size: 16px;
        color: #296191;
        display: block;
        margin: 0 3px 3px 0;
        float: left;
    }

        span.date:nth-child(3n)
        {
            margin-right: 0;
        }

    legend
    {
        height: 50px;
        font-size: 18px;
    }

    .btn-primary
    {
        float: right;
    }
</style>
<script type="text/javascript">
    pageSetUp();
    $(function () {
        $("#PhoneNo").mask("(99) 99999999");
        $("#Fax").mask("(99) 99999999");
    });
    //search doctor
    $(document).ready(function () {
        @*Check if user email is existed in database*@
        $("#Search").click(function () {
            var doctorname = $('#DoctorName').val();
            var specialityid = $('#SpecialityID').val();
            var hospitalid = $('#HospitalID').val();
            if ((doctorname == '' && specialityid != 0) || (doctorname != '' && specialityid == 0) ||
                (doctorname != '' && specialityid != 0)) {
                var statesProgress = $("#states-loading-doctor-progress");
                $("#search-doctor-message").text("");
                $("#invalidIconUser").hide();
                statesProgress.show();
                $.ajax({
                    cache: false,
                    type: "GET",
                    url: "@(Url.RouteUrl(Constants.SearchDoctorAction))",
                    data: { doctorName: doctorname, specialityID: specialityid, hospitalID: hospitalid },
                    success: function (data) {
                        $('#SearchResult').replaceWith(data);
                        statesProgress.hide();
                    },
                    error: function (xhr, ajaxOptions, thrownError) {
                        $('#wid-id-1').replaceWith(data);
                        statesProgress.hide();
                    }
                });
            } else {
                $("#search-doctor-message").text("Xin hãy nhập tên bác sĩ hoặc chọn một chuyên khoa");
                $("#invalidIconUser").show();
                return false;
            }
        });

        // update doctor information

    });

</script>


